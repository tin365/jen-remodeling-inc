(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[698],{2890:(e,t,s)=>{"use strict";s.d(t,{N:()=>a});let a=(0,s(2373).UU)("https://eqvkvorzzyqtfvsnigru.supabase.co","sb_publishable_C9V3cLFgWxrreFFFvHil3g_xbIsgQX8")},5023:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>m});var a=s(5155),i=s(2115),n=s(2619),l=s.n(n),r=s(2890);async function c(){let{data:{user:e}}=await r.N.auth.getUser();if(!e)return null;let{data:t}=await r.N.from("admin_users").select("user_id").eq("user_id",e.id).maybeSingle();return t?{user:e,isAdmin:!0}:null}async function d(e,t){let{data:{user:s},error:a}=await r.N.auth.signInWithPassword({email:e,password:t});if(a)return a.message.toLowerCase().includes("invalid")?{error:"Invalid email or password."}:{error:a.message};if(!s)return{error:"Sign in failed."};let{data:i}=await r.N.from("admin_users").select("user_id").eq("user_id",s.id).maybeSingle();return i?{error:null}:(await r.N.auth.signOut(),{error:"Access denied. You are not an administrator."})}async function o(){await r.N.auth.signOut()}function m(){let[e,t]=(0,i.useState)(null),[s,n]=(0,i.useState)(!0),[m,h]=(0,i.useState)(""),[x,u]=(0,i.useState)(""),[w,p]=(0,i.useState)(""),[b,N]=(0,i.useState)(!1),[j,g]=(0,i.useState)(!1),[f,v]=(0,i.useState)(null),[y,S]=(0,i.useState)([]),[C,_]=(0,i.useState)([]),[k,D]=(0,i.useState)(!1),[E,L]=(0,i.useState)(!1),[q,A]=(0,i.useState)("contacts"),[F,I]=(0,i.useState)(null),O=(0,i.useCallback)(async()=>{let e=await c();t(e?{user:e.user}:null)},[]);(0,i.useEffect)(()=>{O().finally(()=>n(!1))},[O]);let U=(0,i.useCallback)(async()=>{D(!0);let{data:e}=await r.N.from("contact_submissions").select("*").order("created_at",{ascending:!1});S(null!=e?e:[]),D(!1)},[]),R=(0,i.useCallback)(async()=>{L(!0);let{data:e}=await r.N.from("reviews").select('id, name, service, rating, "text", helpful, created_at').order("created_at",{ascending:!1});_(null!=e?e:[]),L(!1)},[]);(0,i.useEffect)(()=>{e&&(U(),R())},[e,U,R]);let T=async e=>{e.preventDefault(),p(""),N(!0);let{error:t}=await d(m.trim(),x);if(N(!1),t)return void p(t);await O(),u("")},z=async e=>{e.preventDefault(),p(""),v(null),N(!0);let{data:t,error:s}=await r.N.auth.signUp({email:m.trim(),password:x});if(N(!1),s)return void p(s.message);t.user&&(await r.N.auth.signOut(),v(t.user.id),u(""))},B=async()=>{await o(),t(null)},P=async e=>{confirm("Delete this submission?")&&(I(e),await r.N.from("contact_submissions").delete().eq("id",e),await U(),I(null))},V=async e=>{confirm("Delete this review?")&&(I(e),await r.N.from("reviews").delete().eq("id",e),await R(),I(null))},Q=e=>new Date(e).toLocaleString();return s?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-white/80",children:"Loading..."})}):e?(0,a.jsxs)("div",{className:"min-h-screen",children:[(0,a.jsxs)("header",{className:"sticky top-0 z-50 border-b border-white/20 bg-[#1a1a1a] px-6 py-4 flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-6",children:[(0,a.jsx)("h1",{className:"text-lg font-bold",children:"Admin"}),(0,a.jsxs)("nav",{className:"flex gap-4",children:[(0,a.jsx)("button",{type:"button",onClick:()=>A("contacts"),className:"text-sm ".concat("contacts"===q?"text-white underline":"text-white/70 hover:text-white"),children:"Contact submissions"}),(0,a.jsx)("button",{type:"button",onClick:()=>A("reviews"),className:"text-sm ".concat("reviews"===q?"text-white underline":"text-white/70 hover:text-white"),children:"Reviews"})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("span",{className:"text-sm text-white/60",children:e.user.email}),(0,a.jsx)(l(),{href:"/",className:"text-sm text-white/70 hover:text-white",children:"View site"}),(0,a.jsx)("button",{type:"button",onClick:B,className:"text-sm text-white/70 hover:text-white",children:"Sign out"})]})]}),(0,a.jsxs)("div",{className:"p-6 max-w-5xl mx-auto",children:["contacts"===q&&(0,a.jsxs)("section",{children:[(0,a.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Contact submissions"}),k?(0,a.jsx)("p",{className:"text-white/70",children:"Loading..."}):0===y.length?(0,a.jsx)("p",{className:"text-white/70",children:"No submissions yet."}):(0,a.jsx)("div",{className:"space-y-4",children:y.map(e=>(0,a.jsx)("div",{className:"border border-white/20 rounded-lg p-4 bg-white/5",children:(0,a.jsxs)("div",{className:"flex justify-between items-start gap-4",children:[(0,a.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,a.jsx)("p",{className:"font-medium",children:e.name}),(0,a.jsxs)("p",{className:"text-sm text-white/70",children:[e.email," \xb7 ",e.phone]}),(0,a.jsxs)("p",{className:"text-sm mt-1",children:["Service: ",e.service]}),e.budget&&(0,a.jsxs)("p",{className:"text-sm",children:["Budget: ",e.budget]}),e.timeline&&(0,a.jsxs)("p",{className:"text-sm",children:["Timeline: ",e.timeline]}),(0,a.jsx)("p",{className:"text-sm mt-2 text-white/80",children:e.message}),(0,a.jsx)("p",{className:"text-xs text-white/50 mt-2",children:Q(e.created_at)})]}),(0,a.jsx)("button",{type:"button",onClick:()=>P(e.id),disabled:F===e.id,className:"shrink-0 text-sm text-red-400 hover:text-red-300 disabled:opacity-50",children:"Delete"})]})},e.id))})]}),"reviews"===q&&(0,a.jsxs)("section",{children:[(0,a.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Reviews"}),E?(0,a.jsx)("p",{className:"text-white/70",children:"Loading..."}):0===C.length?(0,a.jsx)("p",{className:"text-white/70",children:"No reviews yet."}):(0,a.jsx)("div",{className:"space-y-4",children:C.map(e=>(0,a.jsx)("div",{className:"border border-white/20 rounded-lg p-4 bg-white/5",children:(0,a.jsxs)("div",{className:"flex justify-between items-start gap-4",children:[(0,a.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,a.jsx)("p",{className:"font-medium",children:e.name}),(0,a.jsxs)("p",{className:"text-sm text-white/70",children:[e.service," \xb7 ",e.rating,"/5"]}),(0,a.jsx)("p",{className:"text-sm mt-1 text-white/80",children:e.text}),(0,a.jsx)("p",{className:"text-xs text-white/50 mt-2",children:Q(e.created_at)})]}),(0,a.jsx)("button",{type:"button",onClick:()=>V(e.id),disabled:F===e.id,className:"shrink-0 text-sm text-red-400 hover:text-red-300 disabled:opacity-50",children:"Delete"})]})},e.id))})]})]})]}):(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center p-6",children:(0,a.jsxs)("div",{className:"w-full max-w-sm border border-white/20 rounded-lg p-8 bg-white/5",children:[(0,a.jsx)("h1",{className:"text-xl font-bold mb-2",children:j?"Create admin account":"Admin sign in"}),(0,a.jsx)("p",{className:"text-sm text-white/70 mb-6",children:j?"Create an account, then add your User ID to admin_users in Supabase to get access.":"Sign in with your administrator account."}),f?(0,a.jsxs)("div",{className:"space-y-4 text-sm",children:[(0,a.jsx)("p",{className:"text-green-400",children:"Account created."}),(0,a.jsx)("p",{className:"text-white/80",children:"Run this in Supabase Dashboard → SQL Editor to grant admin access:"}),(0,a.jsx)("pre",{className:"p-3 bg-black/30 rounded overflow-x-auto text-xs break-all",children:"INSERT INTO admin_users (user_id) VALUES ('".concat(f,"');")}),(0,a.jsx)("p",{className:"text-white/70",children:"Then sign in above."}),(0,a.jsx)("button",{type:"button",onClick:()=>{v(null),g(!1)},className:"text-white/70 hover:text-white",children:"← Back to sign in"})]}):(0,a.jsxs)("form",{onSubmit:j?z:T,className:"space-y-4",children:[w&&(0,a.jsx)("p",{className:"text-sm text-red-400",role:"alert",children:w}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"admin-email",className:"block text-sm mb-1",children:"Email"}),(0,a.jsx)("input",{id:"admin-email",type:"email",value:m,onChange:e=>h(e.target.value),required:!0,autoComplete:"email",className:"w-full px-3 py-2 rounded border border-white/20 bg-white/10 text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-white/30",placeholder:"admin@example.com"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"admin-password",className:"block text-sm mb-1",children:"Password"}),(0,a.jsx)("input",{id:"admin-password",type:"password",value:x,onChange:e=>u(e.target.value),required:!0,autoComplete:j?"new-password":"current-password",minLength:6,className:"w-full px-3 py-2 rounded border border-white/20 bg-white/10 text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-white/30",placeholder:"••••••••"})]}),(0,a.jsx)("button",{type:"submit",disabled:b,className:"w-full py-2 px-4 bg-white text-[#1a1a1a] font-medium rounded hover:bg-white/90 disabled:opacity-50",children:b?j?"Creating...":"Signing in...":j?"Create account":"Sign in"}),(0,a.jsx)("p",{className:"text-center",children:(0,a.jsx)("button",{type:"button",onClick:()=>{g(!j),p("")},className:"text-sm text-white/70 hover:text-white",children:j?"Already have an account? Sign in":"Need an account? Create one"})})]}),(0,a.jsx)("p",{className:"mt-6 text-center",children:(0,a.jsx)(l(),{href:"/",className:"text-sm text-white/70 hover:text-white",children:"← Back to site"})})]})})}},9421:(e,t,s)=>{Promise.resolve().then(s.bind(s,5023))}},e=>{e.O(0,[619,373,441,255,358],()=>e(e.s=9421)),_N_E=e.O()}]);